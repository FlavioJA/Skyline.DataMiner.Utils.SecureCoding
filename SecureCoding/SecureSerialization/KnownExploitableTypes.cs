using System;
using System.Collections.Generic;
using System.Runtime.CompilerServices;
using System.Text;

namespace SecureCoding.SecureSerialization
{
    internal static class KnownExploitableTypes
    {
        private static readonly List<string> knownExploitableTypes = new List<string>
        {
            // List based on the gadgets available in ysoserial.net
            "System.Workflow.ComponentModel.Serialization.ActivitySurrogateDisableTypeCheck",
            "System.Workflow.ComponentModel.Serialization.ActivitySurrogateSelector",
            "System.Windows.Forms.AxHostState",
            "System.Security.Claims.ClaimsIdentity",
            "System.Security.ClaimsClaimsPrincipal",
            "System.Data.DataSet",
            "System.Security.Principal.GenericPrincipal",
            "System.Windows.Data.ObjectDataProvider",
            "System.Runtime.Remoting.ObjRef",
            "System.Management.Automation.PSObject",
            "System.Resources.ResourceSet",
            "System.Web.Security.RolePrincipal",
            "System.IdentityModel.TokensSessionSecurityToken",
            "System.Web.UI.MobileControls.SessionViewState+SessionViewStateHistoryItem",
            "Microsoft.VisualStudio.Text.Formatting.TextFormattingRunProperties",
            "System.Drawing.Design.ToolboxItemContainer",
            "Microsoft.IdentityModel.Claims.WindowsClaimsIdentity",
            "System.Security.Principal.WindowsIdentity",
            "System.Security.Principal.WindowsPrincipal",
        };

        internal static bool Contains(Type type)
        {
            return knownExploitableTypes.Exists(t => type.FullName.Contains(t));
        }

        internal static bool IsKnownExploitableType(this Type type)
        {
            return Contains(type);
        }

    }
}
